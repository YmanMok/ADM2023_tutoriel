R Notebook
================
Yman Mokrani

``` bash
wget https://github.com/ANF-MetaBioDiv/course-material/archive/refs/heads/main.zip
unzip main.zip
```

#### Cette condition permet de ne pas remplacer un dossier déjà existant.

``` r
refdb_folder <- here::here("data", "refdb")
refdb_folder
```

    ## [1] "/home/rstudio/ADM2023_tutoriel/data/refdb"

``` r
if (!dir.exists(refdb_folder)) dir.create(refdb_folder, recursive = TRUE)
```

``` bash
cp -R course-material-main/data/raw ./data
```

``` r
# so we change timeout to be 20 minutes
options(timeout = 1200)

# we save in variable the path to the refdb
# in the working space
silva_train_set <- file.path (refdb_folder, "silva_nr99_v138.1_train_set.fa.gz")

silva_species_assignment <- file.path(refdb_folder,
                                      "silva_species_assignment_v138.1.fa.gz")

# then we download the files if they don't already exist

if (!file.exists(silva_train_set)) {
  download.file(
    "https://zenodo.org/record/4587955/files/silva_nr99_v138.1_train_set.fa.gz",
    silva_train_set,
    quiet = TRUE
  )
}

if (!file.exists(silva_species_assignment)) {
  download.file(
    "https://zenodo.org/record/4587955/files/silva_species_assignment_v138.1.fa.gz",
    silva_species_assignment,
    quiet = TRUE
  )
}
```

#### Chercher toutes les fonctions dans r

``` r
devtools::load_all(path="/home/rstudio/ADM2023_tutoriel/course-material-main/R")
```

    ## ℹ Loading ANF_metaB

``` r
path_to_fastqs <- here::here("data", "raw")
```

#### le liste des fichiers qui contient tous

``` r
fnFs <- sort(list.files(path_to_fastqs,
                        pattern = "_R1.fastq.gz",
                        full.names = TRUE))
```

``` r
fnRs <- sort(list.files(path_to_fastqs,
                        pattern = "_R2.fastq.gz",
                        full.names = TRUE))
```

#### base name==\> nom du fichier

#### string split ==\> découpage de chaine de caractère avec comme séparateur le undersocre “*” Il y a dessus elements découpés par * dans la chaine de caractère

#### Si 3 valeurs alors 2 \_ pour séparer

#### sapply ==\> récupère le 1er element

``` r
sample_names <- basename(fnFs) |>
  strsplit(split = "_") |>
  sapply(head, 1)
```

``` r
basename(fnFs) |>
  head()
```

    ## [1] "S11B_R1.fastq.gz" "S1B_R1.fastq.gz"  "S2B_R1.fastq.gz"  "S2S_R1.fastq.gz" 
    ## [5] "S3B_R1.fastq.gz"  "S3S_R1.fastq.gz"

``` r
basename(fnFs) |>
  strsplit(split = "_") |>
  sapply(head, 1) |>
  head()
```

    ## [1] "S11B" "S1B"  "S2B"  "S2S"  "S3B"  "S3S"

### 3. Contrôle de qualité des séquences

``` r
# create a directory for the outputs
quality_folder <- here::here("outputs",
                             "dada2",
                             "quality_plots")

if (!dir.exists(quality_folder)) {
  dir.create(quality_folder, recursive = TRUE)
}

qualityprofile(fnFs,
               fnRs,
               file.path(quality_folder, "quality_plots.pdf"))
```

    ## png 
    ##   2

``` r
path_to_trimmed_reads <- here::here(
  "outputs",
  "dada2",
  "trimmed"
)

if (!dir.exists(path_to_trimmed_reads)) dir.create(path_to_trimmed_reads, recursive = TRUE)
```

``` r
primer_fwd  <- "CCTACGGGNBGCASCAG"
primer_rev  <- "GACTACNVGGGTATCTAAT"
```

``` r
Biostrings::readDNAStringSet(
  fnFs[1],
  format = "fastq",
  nrec = 10
)
```

    ## DNAStringSet object of length 10:
    ##      width seq                                              names               
    ##  [1]   293 CCTACGGGGGGCAGCAGTAGGGA...ACATCGGCTTAACCGATGAAGT M01522:260:000000...
    ##  [2]   293 CCTACGGGTGGCACCAGTAGGGA...CGGGGCTTAACCTCGGAACTGC M01522:260:000000...
    ##  [3]   292 CCTACGGGGCGCAGCAGGCGCGA...GGGACCGGGAGAGGTGTGAGGT M01522:260:000000...
    ##  [4]   293 CCTACGGGGTGCAGCAGTAGGGA...TCAAAACTCCCAGTCTAGAGTT M01522:260:000000...
    ##  [5]   291 CCTACGGGTGGCAGCAGTGGGGA...GCAGTGGAAACTGTTGGGCTTG M01522:260:000000...
    ##  [6]   293 CCTACGGGATGCAGCAGGCGCGA...GGGACCGGGAGAGGTGTGGGGG M01522:260:000000...
    ##  [7]   292 CCTACGGGATGCAGCAGTGGGGA...TTTAATCCTGATGAGCTAGAAA M01522:260:000000...
    ##  [8]   293 CCTACGGGGCGCAGCAGTAGGGA...TTAAAACTTTTGTTCTGGAATT M01522:260:000000...
    ##  [9]   292 CCTACGGGTTGCAGCAGTGGGGA...ATTAAAACTTTTCAGCTAGAGT M01522:260:000000...
    ## [10]   293 CCTACGGGAGGCAGCAGTGGGGA...CCCGGGCTCAACCTGGGAACGG M01522:260:000000...

``` r
Biostrings::readDNAStringSet(
  fnRs[1],
  format = "fastq",
  nrec = 10
)
```

    ## DNAStringSet object of length 10:
    ##      width seq                                              names               
    ##  [1]   301 GACTACCAGGGTATCTAATCCTG...GGCTGCTGGCACGAAGTTCGCC M01522:260:000000...
    ##  [2]   301 GACTACCGGGGTATCTAATCCTG...GGCTGCTGGCACGGAGTTAGCC M01522:260:000000...
    ##  [3]   300 AATCCGGTTCGTGCCCCTAGGCT...TCTTTCCCAGCCCTTATTCCAA M01522:260:000000...
    ##  [4]   301 GACTACCGGGGTATCTAATCCTG...GGCTGCTGGCACGGAGTTAGCC M01522:260:000000...
    ##  [5]   301 GACTACCGGGGTATCTAATCCCT...GGCTGCTGGCCCGGAATTAGCC M01522:260:000000...
    ##  [6]   301 GGTATCTAATCCGGTTCGTGCCC...CACCGTCCTTACCCCCCCCTTT M01522:260:000000...
    ##  [7]   301 GGTATCTAATCTTGTTTGCTCCC...CCCGACGTTAGCCGGGGCTTCT M01522:260:000000...
    ##  [8]   301 GACTACGAGGGTATCTAATCCCG...GGCTGCTGGCACGGAATTAGCC M01522:260:000000...
    ##  [9]   301 GGTATCTAATCCTCTTCGCTACC...CACGAAGTTAGCCGGACCTTCT M01522:260:000000...
    ## [10]   301 GACTACGGGGGTATCTAATCCTG...GGCTGCCGGCACGGGGTTAGCC M01522:260:000000...

``` bash
pwd
cp -R /home/rstudio/ADM2023_tutoriel/course-material-main/bash .
```

    ## /home/rstudio/ADM2023_tutoriel

``` r
(primer_log <- primer_trim(
  forward_files = fnFs,
  reverse_files = fnRs,
  primer_fwd = primer_fwd,
  primer_rev = primer_rev,
  output_dir = path_to_trimmed_reads,
  min_size = 200
))
```

    ##    sample status in_reads   in_bp too_short too_long too_many_n out_reads
    ## 1    S11B     OK     2000 1186767         0        0          0      1863
    ## 2     S1B     OK     2000 1186613         1        0          0      1855
    ## 3     S2B     OK     2000 1186942         0        0          0      1839
    ## 4     S2S     OK     2000 1186868         0        0          0      1833
    ## 5     S3B     OK     2000 1186650         0        0          0      1860
    ## 6     S3S     OK     2000 1186475         1        0          0      1880
    ## 7     S4B     OK     2000 1186331         2        0          0      1867
    ## 8     S4S     OK     2000 1186681         0        0          0      1872
    ## 9     S5B     OK     2000 1186386         1        0          0      1841
    ## 10    S5S     OK     2000 1186501         1        0          0      1861
    ## 11    S6B     OK     2000 1186261         2        0          0      1839
    ## 12    S6S     OK     2000 1187078         1        0          0      1835
    ## 13    S7B     OK     2000 1186888         0        0          0      1825
    ## 14    S7S     OK     2000 1186299         3        0          0      1845
    ## 15    S8B     OK     2000 1186354         3        0          0      1840
    ## 16    S8S     OK     2000 1186610         1        0          0      1848
    ## 17    S9B     OK     2000 1187038         0        0          0      1834
    ## 18    S9S     OK     2000 1186867         0        0          0      1835
    ##    w/adapters qualtrim_bp out_bp w/adapters2 qualtrim2_bp out2_bp
    ## 1        1986           0 513149        1876            0  528595
    ## 2        1975           0 511096        1877            0  525893
    ## 3        1987           0 506659        1850            0  521371
    ## 4        1989           0 504998        1843            0  519979
    ## 5        1989           0 512326        1870            0  527518
    ## 6        1989           0 517598        1891            0  532758
    ## 7        1980           0 514342        1884            0  529379
    ## 8        1987           0 515511        1884            0  530555
    ## 9        1984           0 506972        1856            0  522013
    ## 10       1991           0 512539        1869            0  527592
    ## 11       1981           0 506577        1857            0  521787
    ## 12       1982           0 505929        1851            0  520562
    ## 13       1987           0 503033        1836            0  517931
    ## 14       1987           0 508524        1857            0  523039
    ## 15       1993           0 507178        1847            0  522137
    ## 16       1982           0 509177        1865            0  524085
    ## 17       1983           0 505424        1851            0  520706
    ## 18       1979           0 505519        1853            0  520103

``` r
nopFw <- sort(list.files(path_to_trimmed_reads, pattern = "R1", full.names = TRUE))
nopRv <- sort(list.files(path_to_trimmed_reads, pattern = "R2", full.names = TRUE))
```

#### 5.

``` r
path_to_filtered_reads <- here::here("outputs", "dada2", "filtered")
if (!dir.exists(path_to_filtered_reads)) dir.create(path_to_filtered_reads, recursive = TRUE)
```

``` r
filtFs <- file.path(path_to_filtered_reads, basename(fnFs))
filtRs <- file.path(path_to_filtered_reads, basename(fnRs))
```

``` r
names(filtFs) <- sample_names
names(filtRs) <- sample_names
```

#### 5

``` r
(out <- dada2::filterAndTrim(
  fwd = nopFw,
  filt = filtFs,
  rev = nopRv,
  filt.rev = filtRs,
  minLen = 150,
  matchIDs = TRUE,
  maxN = 0,
  maxEE = c(3, 3),
  truncQ = 2
))
```

    ##                  reads.in reads.out
    ## S11B_R1.fastq.gz     1863      1200
    ## S1B_R1.fastq.gz      1855      1251
    ## S2B_R1.fastq.gz      1839      1255
    ## S2S_R1.fastq.gz      1833      1244
    ## S3B_R1.fastq.gz      1860      1244
    ## S3S_R1.fastq.gz      1880      1312
    ## S4B_R1.fastq.gz      1867      1262
    ## S4S_R1.fastq.gz      1872      1328
    ## S5B_R1.fastq.gz      1841      1255
    ## S5S_R1.fastq.gz      1861      1244
    ## S6B_R1.fastq.gz      1839      1251
    ## S6S_R1.fastq.gz      1835      1239
    ## S7B_R1.fastq.gz      1825      1203
    ## S7S_R1.fastq.gz      1845      1182
    ## S8B_R1.fastq.gz      1840      1169
    ## S8S_R1.fastq.gz      1848      1267
    ## S9B_R1.fastq.gz      1834      1195
    ## S9S_R1.fastq.gz      1835      1249

#### 6.1

``` r
errF <- dada2::learnErrors(filtFs,
                           randomize = TRUE,
                           multithread = TRUE)
```

    ## 6157072 total bases in 22350 reads from 18 samples will be used for learning the error rates.

``` r
errR <- dada2::learnErrors(filtRs,
                           randomize = TRUE,
                           multithread = TRUE)
```

    ## 6337638 total bases in 22350 reads from 18 samples will be used for learning the error rates.

``` r
dada2::plotErrors(errF, nominalQ=TRUE)
```

    ## Warning: Transformation introduced infinite values in continuous y-axis
    ## Transformation introduced infinite values in continuous y-axis

![](TD1_ADM2023_files/figure-gfm/unnamed-chunk-26-1.png)<!-- -->

### 6.2

#### on enleve les séquences identiques et on garde que les séquences représentatives.

``` r
derepFs <- dada2::derepFastq(filtFs, verbose = TRUE)
```

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S11B_R1.fastq.gz

    ## Encountered 754 unique sequences from 1200 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S1B_R1.fastq.gz

    ## Encountered 779 unique sequences from 1251 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S2B_R1.fastq.gz

    ## Encountered 789 unique sequences from 1255 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S2S_R1.fastq.gz

    ## Encountered 762 unique sequences from 1244 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S3B_R1.fastq.gz

    ## Encountered 772 unique sequences from 1244 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S3S_R1.fastq.gz

    ## Encountered 763 unique sequences from 1312 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S4B_R1.fastq.gz

    ## Encountered 738 unique sequences from 1262 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S4S_R1.fastq.gz

    ## Encountered 638 unique sequences from 1328 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S5B_R1.fastq.gz

    ## Encountered 782 unique sequences from 1255 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S5S_R1.fastq.gz

    ## Encountered 663 unique sequences from 1244 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S6B_R1.fastq.gz

    ## Encountered 696 unique sequences from 1251 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S6S_R1.fastq.gz

    ## Encountered 657 unique sequences from 1239 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S7B_R1.fastq.gz

    ## Encountered 691 unique sequences from 1203 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S7S_R1.fastq.gz

    ## Encountered 675 unique sequences from 1182 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S8B_R1.fastq.gz

    ## Encountered 697 unique sequences from 1169 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S8S_R1.fastq.gz

    ## Encountered 714 unique sequences from 1267 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S9B_R1.fastq.gz

    ## Encountered 685 unique sequences from 1195 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S9S_R1.fastq.gz

    ## Encountered 677 unique sequences from 1249 total sequences read.

``` r
derepRs <- dada2::derepFastq(filtRs, verbose = TRUE)
```

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S11B_R2.fastq.gz

    ## Encountered 928 unique sequences from 1200 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S1B_R2.fastq.gz

    ## Encountered 948 unique sequences from 1251 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S2B_R2.fastq.gz

    ## Encountered 968 unique sequences from 1255 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S2S_R2.fastq.gz

    ## Encountered 925 unique sequences from 1244 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S3B_R2.fastq.gz

    ## Encountered 948 unique sequences from 1244 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S3S_R2.fastq.gz

    ## Encountered 967 unique sequences from 1312 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S4B_R2.fastq.gz

    ## Encountered 953 unique sequences from 1262 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S4S_R2.fastq.gz

    ## Encountered 904 unique sequences from 1328 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S5B_R2.fastq.gz

    ## Encountered 975 unique sequences from 1255 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S5S_R2.fastq.gz

    ## Encountered 887 unique sequences from 1244 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S6B_R2.fastq.gz

    ## Encountered 914 unique sequences from 1251 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S6S_R2.fastq.gz

    ## Encountered 846 unique sequences from 1239 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S7B_R2.fastq.gz

    ## Encountered 881 unique sequences from 1203 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S7S_R2.fastq.gz

    ## Encountered 874 unique sequences from 1182 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S8B_R2.fastq.gz

    ## Encountered 879 unique sequences from 1169 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S8S_R2.fastq.gz

    ## Encountered 967 unique sequences from 1267 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S9B_R2.fastq.gz

    ## Encountered 892 unique sequences from 1195 total sequences read.

    ## Dereplicating sequence entries in Fastq file: /home/rstudio/ADM2023_tutoriel/outputs/dada2/filtered/S9S_R2.fastq.gz

    ## Encountered 911 unique sequences from 1249 total sequences read.

### 6.3

``` r
dadaFs <- dada2::dada(derepFs, err = errF, multithread = TRUE)
```

    ## Sample 1 - 1200 reads in 754 unique sequences.
    ## Sample 2 - 1251 reads in 779 unique sequences.
    ## Sample 3 - 1255 reads in 789 unique sequences.
    ## Sample 4 - 1244 reads in 762 unique sequences.
    ## Sample 5 - 1244 reads in 772 unique sequences.
    ## Sample 6 - 1312 reads in 763 unique sequences.
    ## Sample 7 - 1262 reads in 738 unique sequences.
    ## Sample 8 - 1328 reads in 638 unique sequences.
    ## Sample 9 - 1255 reads in 782 unique sequences.
    ## Sample 10 - 1244 reads in 663 unique sequences.
    ## Sample 11 - 1251 reads in 696 unique sequences.
    ## Sample 12 - 1239 reads in 657 unique sequences.
    ## Sample 13 - 1203 reads in 691 unique sequences.
    ## Sample 14 - 1182 reads in 675 unique sequences.
    ## Sample 15 - 1169 reads in 697 unique sequences.
    ## Sample 16 - 1267 reads in 714 unique sequences.
    ## Sample 17 - 1195 reads in 685 unique sequences.
    ## Sample 18 - 1249 reads in 677 unique sequences.

``` r
dadaRs <- dada2::dada(derepRs, err = errR, multithread = TRUE)
```

    ## Sample 1 - 1200 reads in 928 unique sequences.
    ## Sample 2 - 1251 reads in 948 unique sequences.
    ## Sample 3 - 1255 reads in 968 unique sequences.
    ## Sample 4 - 1244 reads in 925 unique sequences.
    ## Sample 5 - 1244 reads in 948 unique sequences.
    ## Sample 6 - 1312 reads in 967 unique sequences.
    ## Sample 7 - 1262 reads in 953 unique sequences.
    ## Sample 8 - 1328 reads in 904 unique sequences.
    ## Sample 9 - 1255 reads in 975 unique sequences.
    ## Sample 10 - 1244 reads in 887 unique sequences.
    ## Sample 11 - 1251 reads in 914 unique sequences.
    ## Sample 12 - 1239 reads in 846 unique sequences.
    ## Sample 13 - 1203 reads in 881 unique sequences.
    ## Sample 14 - 1182 reads in 874 unique sequences.
    ## Sample 15 - 1169 reads in 879 unique sequences.
    ## Sample 16 - 1267 reads in 967 unique sequences.
    ## Sample 17 - 1195 reads in 892 unique sequences.
    ## Sample 18 - 1249 reads in 911 unique sequences.

### 7.

``` r
mergers <- dada2::mergePairs(
  dadaF = dadaFs,
  derepF = derepFs,
  dadaR = dadaRs,
  derepR = derepRs,
  maxMismatch = 0,
  verbose = TRUE
)
```

    ## 879 paired-reads (in 28 unique pairings) successfully merged out of 970 (in 51 pairings) input.

    ## 835 paired-reads (in 33 unique pairings) successfully merged out of 943 (in 63 pairings) input.

    ## 783 paired-reads (in 30 unique pairings) successfully merged out of 944 (in 59 pairings) input.

    ## 929 paired-reads (in 32 unique pairings) successfully merged out of 1040 (in 59 pairings) input.

    ## 786 paired-reads (in 26 unique pairings) successfully merged out of 927 (in 60 pairings) input.

    ## 920 paired-reads (in 36 unique pairings) successfully merged out of 1040 (in 60 pairings) input.

    ## 808 paired-reads (in 29 unique pairings) successfully merged out of 971 (in 62 pairings) input.

    ## 1050 paired-reads (in 32 unique pairings) successfully merged out of 1130 (in 56 pairings) input.

    ## 905 paired-reads (in 24 unique pairings) successfully merged out of 1036 (in 40 pairings) input.

    ## 898 paired-reads (in 27 unique pairings) successfully merged out of 1039 (in 56 pairings) input.

    ## 970 paired-reads (in 31 unique pairings) successfully merged out of 1061 (in 51 pairings) input.

    ## 900 paired-reads (in 23 unique pairings) successfully merged out of 1062 (in 62 pairings) input.

    ## 823 paired-reads (in 31 unique pairings) successfully merged out of 988 (in 67 pairings) input.

    ## 852 paired-reads (in 30 unique pairings) successfully merged out of 968 (in 48 pairings) input.

    ## 842 paired-reads (in 26 unique pairings) successfully merged out of 944 (in 58 pairings) input.

    ## 849 paired-reads (in 31 unique pairings) successfully merged out of 1031 (in 62 pairings) input.

    ## 787 paired-reads (in 25 unique pairings) successfully merged out of 976 (in 55 pairings) input.

    ## 873 paired-reads (in 29 unique pairings) successfully merged out of 1044 (in 57 pairings) input.

#### assemblage ==\> contig ==\> plus de rid 1 et 2

#### si mismatch il enleve les séquences

### 8

``` r
seqtab <- dada2::makeSequenceTable(mergers)
```

### 9

``` r
seqtab_nochim <- dada2::removeBimeraDenovo(seqtab,
                                           method = "consensus",
                                           multithread = TRUE,
                                           verbose = TRUE)
```

    ## Identified 2 bimeras out of 162 input sequences.

### 10

``` r
taxonomy <- dada2::assignTaxonomy(
  seqs = seqtab_nochim,
  refFasta = silva_train_set,
  taxLevels = c("Kingdom", "Phylum", "Class",
                "Order", "Family", "Genus",
                "Species"),
  multithread = TRUE,
  minBoot = 60
)
```

``` r
taxonomy <- dada2::addSpecies(
  taxonomy,
  silva_species_assignment,
  allowMultiple = FALSE
)
```

### 11.1 EXPORT

``` r
export_folder <- here::here("outputs", "dada2", "asv_table")

if (!dir.exists(export_folder)) dir.create(export_folder, recursive = TRUE)

saveRDS(object = seqtab_nochim,
        file = file.path(export_folder, "seqtab_nochim.rds"))

saveRDS(object = taxonomy,
        file = file.path(export_folder, "taxonomy.rds"))
```

#### Résultat Seqtab_nochim (PREND BCP DE PLACE ET PAS INTERESSANT)

\######`{r} ######ResultatSeqtab_nochim <- readRDS("outputs/dada2/asv_table/seqtab_nochim.rds") ######ResultatSeqtab_nochim ######`

#### Résultat Taxonomietsv (long et pas interessant)

\######`{r} ######ResultatTaxo <- readRDS("outputs/dada2/asv_table/taxonomy.rds") ######ResultatTaxo ######`

### 11.2

``` r
asv_seq <- colnames(seqtab_nochim)
```

``` r
ndigits <- nchar(length(asv_seq))
asv_id <- sprintf(paste0("ASV_%0", ndigits, "d"), seq_along(asv_seq))
```

``` r
row.names(taxonomy) <- colnames(seqtab_nochim) <- names(asv_seq) <- asv_id
```

``` r
taxonomy_export <- df_export(taxonomy, new_rn = "asv")

seqtab_nochim_export <- t(seqtab_nochim)
seqtab_nochim_export <- df_export(seqtab_nochim_export, new_rn = "asv")
```

``` r
write.table(taxonomy_export,
            file = file.path(export_folder, "taxonomy.tsv"),
            quote = FALSE,
            sep = "\t",
            row.names = FALSE)
```

#### Résultat Taxonomie tsv

``` r
ResultatTaxotsv <- read.delim("outputs/dada2/asv_table/taxonomy.tsv")
ResultatTaxotsv
```

    ##         asv  Kingdom                        Phylum               Class
    ## 1   ASV_001 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 2   ASV_002 Bacteria                Proteobacteria Alphaproteobacteria
    ## 3   ASV_003 Bacteria                Proteobacteria Gammaproteobacteria
    ## 4   ASV_004 Bacteria                Proteobacteria Alphaproteobacteria
    ## 5   ASV_005  Archaea              Thermoplasmatota      Thermoplasmata
    ## 6   ASV_006 Bacteria                Proteobacteria Alphaproteobacteria
    ## 7   ASV_007 Bacteria                Proteobacteria Gammaproteobacteria
    ## 8   ASV_008 Bacteria                Proteobacteria Alphaproteobacteria
    ## 9   ASV_009 Bacteria                Proteobacteria Alphaproteobacteria
    ## 10  ASV_010 Bacteria                Proteobacteria Alphaproteobacteria
    ## 11  ASV_011 Bacteria                Proteobacteria Alphaproteobacteria
    ## 12  ASV_012 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 13  ASV_013 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 14  ASV_014 Bacteria                Proteobacteria Alphaproteobacteria
    ## 15  ASV_015 Bacteria                Proteobacteria Alphaproteobacteria
    ## 16  ASV_016 Bacteria                Proteobacteria Gammaproteobacteria
    ## 17  ASV_017 Bacteria                Proteobacteria Alphaproteobacteria
    ## 18  ASV_018 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 19  ASV_019  Archaea              Thermoplasmatota      Thermoplasmata
    ## 20  ASV_020  Archaea              Thermoplasmatota      Thermoplasmata
    ## 21  ASV_021 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 22  ASV_022 Bacteria                  Bacteroidota         Bacteroidia
    ## 23  ASV_023 Bacteria                Proteobacteria Alphaproteobacteria
    ## 24  ASV_024 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 25  ASV_025 Bacteria                Proteobacteria Gammaproteobacteria
    ## 26  ASV_026 Bacteria                Proteobacteria Gammaproteobacteria
    ## 27  ASV_027 Bacteria                Proteobacteria Alphaproteobacteria
    ## 28  ASV_028 Bacteria                Proteobacteria Alphaproteobacteria
    ## 29  ASV_029 Bacteria                Proteobacteria Alphaproteobacteria
    ## 30  ASV_030 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 31  ASV_031  Archaea              Thermoplasmatota      Thermoplasmata
    ## 32  ASV_032 Bacteria                Proteobacteria Alphaproteobacteria
    ## 33  ASV_033 Bacteria                  Dadabacteria       Dadabacteriia
    ## 34  ASV_034 Bacteria                Proteobacteria Alphaproteobacteria
    ## 35  ASV_035 Bacteria                Proteobacteria Alphaproteobacteria
    ## 36  ASV_036 Bacteria  SAR324 clade(Marine group B)                <NA>
    ## 37  ASV_037 Bacteria                Proteobacteria Gammaproteobacteria
    ## 38  ASV_038 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 39  ASV_039  Archaea              Thermoplasmatota      Thermoplasmata
    ## 40  ASV_040 Bacteria                Proteobacteria Alphaproteobacteria
    ## 41  ASV_041 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 42  ASV_042 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 43  ASV_043  Archaea              Thermoplasmatota      Thermoplasmata
    ## 44  ASV_044 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 45  ASV_045  Archaea              Thermoplasmatota      Thermoplasmata
    ## 46  ASV_046  Archaea              Thermoplasmatota      Thermoplasmata
    ## 47  ASV_047 Bacteria                Proteobacteria Alphaproteobacteria
    ## 48  ASV_048 Bacteria                   Chloroflexi     Dehalococcoidia
    ## 49  ASV_049 Bacteria                   Chloroflexi     Dehalococcoidia
    ## 50  ASV_050 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 51  ASV_051 Bacteria             Verrucomicrobiota    Verrucomicrobiae
    ## 52  ASV_052 Bacteria  SAR324 clade(Marine group B)                <NA>
    ## 53  ASV_053 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 54  ASV_054 Bacteria                  Bacteroidota         Bacteroidia
    ## 55  ASV_055  Archaea              Thermoplasmatota      Thermoplasmata
    ## 56  ASV_056 Bacteria                Proteobacteria Alphaproteobacteria
    ## 57  ASV_057 Bacteria                Proteobacteria Gammaproteobacteria
    ## 58  ASV_058 Bacteria                  Bacteroidota         Bacteroidia
    ## 59  ASV_059 Bacteria                Proteobacteria Alphaproteobacteria
    ## 60  ASV_060 Bacteria                Proteobacteria Gammaproteobacteria
    ## 61  ASV_061 Bacteria                Proteobacteria Alphaproteobacteria
    ## 62  ASV_062 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 63  ASV_063 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 64  ASV_064 Bacteria                Proteobacteria Gammaproteobacteria
    ## 65  ASV_065 Bacteria                Proteobacteria Alphaproteobacteria
    ## 66  ASV_066 Bacteria                Proteobacteria Alphaproteobacteria
    ## 67  ASV_067 Bacteria                Proteobacteria Gammaproteobacteria
    ## 68  ASV_068 Bacteria                Proteobacteria Gammaproteobacteria
    ## 69  ASV_069 Bacteria                  Bacteroidota         Bacteroidia
    ## 70  ASV_070 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 71  ASV_071 Bacteria                Proteobacteria Gammaproteobacteria
    ## 72  ASV_072 Bacteria                Proteobacteria Alphaproteobacteria
    ## 73  ASV_073 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 74  ASV_074 Bacteria                Proteobacteria Alphaproteobacteria
    ## 75  ASV_075  Archaea              Thermoplasmatota      Thermoplasmata
    ## 76  ASV_076 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 77  ASV_077 Bacteria                Proteobacteria Alphaproteobacteria
    ## 78  ASV_078 Bacteria                Proteobacteria Gammaproteobacteria
    ## 79  ASV_079 Bacteria                Proteobacteria Alphaproteobacteria
    ## 80  ASV_080 Bacteria                Proteobacteria Alphaproteobacteria
    ## 81  ASV_081 Bacteria                  Bacteroidota         Bacteroidia
    ## 82  ASV_082 Bacteria                Proteobacteria Gammaproteobacteria
    ## 83  ASV_083 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 84  ASV_084 Bacteria                Proteobacteria Gammaproteobacteria
    ## 85  ASV_085 Bacteria                Proteobacteria Alphaproteobacteria
    ## 86  ASV_086 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 87  ASV_087  Archaea              Thermoplasmatota      Thermoplasmata
    ## 88  ASV_088 Bacteria                Proteobacteria Gammaproteobacteria
    ## 89  ASV_089 Bacteria                Proteobacteria Alphaproteobacteria
    ## 90  ASV_090 Bacteria                Proteobacteria Gammaproteobacteria
    ## 91  ASV_091 Bacteria                Proteobacteria Gammaproteobacteria
    ## 92  ASV_092 Bacteria                Proteobacteria Alphaproteobacteria
    ## 93  ASV_093 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 94  ASV_094 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 95  ASV_095  Archaea              Thermoplasmatota      Thermoplasmata
    ## 96  ASV_096 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 97  ASV_097  Archaea              Thermoplasmatota      Thermoplasmata
    ## 98  ASV_098 Bacteria                Proteobacteria Gammaproteobacteria
    ## 99  ASV_099 Bacteria                Proteobacteria Gammaproteobacteria
    ## 100 ASV_100 Bacteria                Proteobacteria Alphaproteobacteria
    ## 101 ASV_101 Bacteria                Proteobacteria Alphaproteobacteria
    ## 102 ASV_102  Archaea              Thermoplasmatota      Thermoplasmata
    ## 103 ASV_103 Bacteria                Proteobacteria Alphaproteobacteria
    ## 104 ASV_104  Archaea              Thermoplasmatota      Thermoplasmata
    ## 105 ASV_105 Bacteria                Proteobacteria Gammaproteobacteria
    ## 106 ASV_106 Bacteria                Proteobacteria Alphaproteobacteria
    ## 107 ASV_107 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 108 ASV_108 Bacteria                Proteobacteria Alphaproteobacteria
    ## 109 ASV_109  Archaea              Thermoplasmatota      Thermoplasmata
    ## 110 ASV_110 Bacteria                Proteobacteria Gammaproteobacteria
    ## 111 ASV_111 Bacteria                Proteobacteria Gammaproteobacteria
    ## 112 ASV_112 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 113 ASV_113 Bacteria                Proteobacteria Gammaproteobacteria
    ## 114 ASV_114 Bacteria                  Bacteroidota         Bacteroidia
    ## 115 ASV_115 Bacteria                Proteobacteria Gammaproteobacteria
    ## 116 ASV_116 Bacteria                  Dadabacteria       Dadabacteriia
    ## 117 ASV_117  Archaea              Thermoplasmatota      Thermoplasmata
    ## 118 ASV_118 Bacteria                Proteobacteria Alphaproteobacteria
    ## 119 ASV_119 Bacteria                Proteobacteria Gammaproteobacteria
    ## 120 ASV_120 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 121 ASV_121  Archaea              Thermoplasmatota      Thermoplasmata
    ## 122 ASV_122 Bacteria                Proteobacteria Alphaproteobacteria
    ## 123 ASV_123 Bacteria                Proteobacteria Alphaproteobacteria
    ## 124 ASV_124 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 125 ASV_125 Bacteria                Proteobacteria Alphaproteobacteria
    ## 126 ASV_126 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 127 ASV_127  Archaea              Thermoplasmatota      Thermoplasmata
    ## 128 ASV_128 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 129 ASV_129 Bacteria                Proteobacteria Gammaproteobacteria
    ## 130 ASV_130 Bacteria             Verrucomicrobiota    Verrucomicrobiae
    ## 131 ASV_131 Bacteria                Proteobacteria Gammaproteobacteria
    ## 132 ASV_132 Bacteria                Proteobacteria Gammaproteobacteria
    ## 133 ASV_133 Bacteria                Proteobacteria Alphaproteobacteria
    ## 134 ASV_134 Bacteria                  Bacteroidota         Bacteroidia
    ## 135 ASV_135 Bacteria                Proteobacteria Gammaproteobacteria
    ## 136 ASV_136 Bacteria                Proteobacteria Gammaproteobacteria
    ## 137 ASV_137 Bacteria                Proteobacteria Alphaproteobacteria
    ## 138 ASV_138  Archaea              Thermoplasmatota      Thermoplasmata
    ## 139 ASV_139 Bacteria                  Bacteroidota         Bacteroidia
    ## 140 ASV_140 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 141 ASV_141 Bacteria                Proteobacteria Alphaproteobacteria
    ## 142 ASV_142 Bacteria             Verrucomicrobiota    Verrucomicrobiae
    ## 143 ASV_143 Bacteria                Proteobacteria Alphaproteobacteria
    ## 144 ASV_144 Bacteria                  Bacteroidota         Bacteroidia
    ## 145 ASV_145 Bacteria                Proteobacteria Gammaproteobacteria
    ## 146 ASV_146 Bacteria                Proteobacteria Gammaproteobacteria
    ## 147 ASV_147 Bacteria                Proteobacteria Gammaproteobacteria
    ## 148 ASV_148 Bacteria                Proteobacteria Gammaproteobacteria
    ## 149 ASV_149 Bacteria                Proteobacteria Alphaproteobacteria
    ## 150 ASV_150 Bacteria                  Bacteroidota         Bacteroidia
    ## 151 ASV_151 Bacteria                Proteobacteria Alphaproteobacteria
    ## 152 ASV_152 Bacteria                  Bacteroidota         Bacteroidia
    ## 153 ASV_153 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 154 ASV_154 Bacteria                Proteobacteria Alphaproteobacteria
    ## 155 ASV_155 Bacteria              Desulfobacterota    Desulfuromonadia
    ## 156 ASV_156 Bacteria                Proteobacteria Gammaproteobacteria
    ## 157 ASV_157 Bacteria             Verrucomicrobiota    Verrucomicrobiae
    ## 158 ASV_158 Bacteria                Proteobacteria Alphaproteobacteria
    ## 159 ASV_159 Bacteria                Proteobacteria Alphaproteobacteria
    ## 160 ASV_160 Bacteria                Proteobacteria Alphaproteobacteria
    ##                     Order                  Family                   Genus
    ## 1         Synechococcales            Cyanobiaceae    Synechococcus CC9902
    ## 2             SAR11 clade                 Clade I                Clade Ia
    ## 3        Enterobacterales  Pseudoalteromonadaceae       Pseudoalteromonas
    ## 4             SAR11 clade                 Clade I                Clade Ia
    ## 5         Marine Group II                    <NA>                    <NA>
    ## 6        Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 7        Enterobacterales  Pseudoalteromonadaceae       Pseudoalteromonas
    ## 8             SAR11 clade                Clade II                    <NA>
    ## 9             SAR11 clade                 Clade I                Clade Ia
    ## 10       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 11            SAR11 clade                 Clade I                Clade Ia
    ## 12        Synechococcales            Cyanobiaceae Prochlorococcus MIT9313
    ## 13        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 14            SAR11 clade                Clade II                    <NA>
    ## 15       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 16       Enterobacterales        Alteromonadaceae             Alteromonas
    ## 17            SAR11 clade                 Clade I                Clade Ib
    ## 18        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 19        Marine Group II                    <NA>                    <NA>
    ## 20        Marine Group II                    <NA>                    <NA>
    ## 21            Chloroplast                    <NA>                    <NA>
    ## 22       Flavobacteriales       Flavobacteriaceae        NS4 marine group
    ## 23            SAR11 clade                 Clade I                Clade Ia
    ## 24        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 25        Pseudomonadales             SAR86 clade                    <NA>
    ## 26       Enterobacterales  Pseudoalteromonadaceae       Pseudoalteromonas
    ## 27       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 28            SAR11 clade                 Clade I                Clade Ia
    ## 29            SAR11 clade                 Clade I                Clade Ib
    ## 30        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 31       Marine Group III                    <NA>                    <NA>
    ## 32            SAR11 clade                Clade IV                    <NA>
    ## 33        Dadabacteriales                    <NA>                    <NA>
    ## 34        Rhodobacterales        Rhodobacteraceae                    <NA>
    ## 35       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 36                   <NA>                    <NA>                    <NA>
    ## 37        Pseudomonadales           Moraxellaceae           Acinetobacter
    ## 38        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 39        Marine Group II                    <NA>                    <NA>
    ## 40       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 41        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 42        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 43        Marine Group II                    <NA>                    <NA>
    ## 44        Synechococcales            Cyanobiaceae Prochlorococcus MIT9313
    ## 45        Marine Group II                    <NA>                    <NA>
    ## 46        Marine Group II                    <NA>                    <NA>
    ## 47       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 48           SAR202 clade                    <NA>                    <NA>
    ## 49           SAR202 clade                    <NA>                    <NA>
    ## 50        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 51         Pedosphaerales         Pedosphaeraceae         SCGC AAA164-E04
    ## 52                   <NA>                    <NA>                    <NA>
    ## 53        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 54       Flavobacteriales          Cryomorphaceae                    <NA>
    ## 55        Marine Group II                    <NA>                    <NA>
    ## 56            SAR11 clade                Clade IV                    <NA>
    ## 57        Pseudomonadales             SAR86 clade                    <NA>
    ## 58       Flavobacteriales       Flavobacteriaceae        NS5 marine group
    ## 59     Puniceispirillales            SAR116 clade                    <NA>
    ## 60        Xanthomonadales        Xanthomonadaceae        Stenotrophomonas
    ## 61       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 62            Chloroplast                    <NA>                    <NA>
    ## 63            Chloroplast                    <NA>                    <NA>
    ## 64        Xanthomonadales        Xanthomonadaceae        Stenotrophomonas
    ## 65       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 66        Rhodobacterales        Rhodobacteraceae              Donghicola
    ## 67        Pseudomonadales             SAR86 clade                    <NA>
    ## 68       Enterobacterales            Vibrionaceae                  Vibrio
    ## 69       Flavobacteriales       Flavobacteriaceae        NS5 marine group
    ## 70        Synechococcales            Cyanobiaceae Prochlorococcus MIT9313
    ## 71        Pseudomonadales        Pseudomonadaceae             Pseudomonas
    ## 72        Rhodobacterales        Rhodobacteraceae                    <NA>
    ## 73            Chloroplast                    <NA>                    <NA>
    ## 74       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 75        Marine Group II                    <NA>                    <NA>
    ## 76        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 77        Rhodobacterales        Rhodobacteraceae      Ascidiaceihabitans
    ## 78  Ectothiorhodospirales  Ectothiorhodospiraceae                    <NA>
    ## 79      Thalassobaculales              Nisaeaceae              OM75 clade
    ## 80            SAR11 clade                 Clade I                Clade Ib
    ## 81       Flavobacteriales       Flavobacteriaceae       NS2b marine group
    ## 82        Pseudomonadales             SAR86 clade                    <NA>
    ## 83                   <NA>                    <NA>                    <NA>
    ## 84        Pseudomonadales             SAR86 clade                    <NA>
    ## 85          Rickettsiales                 S25-593                    <NA>
    ## 86                   <NA>                    <NA>                    <NA>
    ## 87        Marine Group II                    <NA>                    <NA>
    ## 88        Pseudomonadales           Moraxellaceae           Psychrobacter
    ## 89       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 90        Pseudomonadales             OM182 clade                    <NA>
    ## 91        Pseudomonadales           Moraxellaceae           Acinetobacter
    ## 92          Rickettsiales                 S25-593                    <NA>
    ## 93                   <NA>                    <NA>                    <NA>
    ## 94                   <NA>                    <NA>                    <NA>
    ## 95        Marine Group II                    <NA>                    <NA>
    ## 96        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 97        Marine Group II                    <NA>                    <NA>
    ## 98        Pseudomonadales             SAR86 clade                    <NA>
    ## 99        Pseudomonadales          Halomonadaceae               Halomonas
    ## 100      Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 101      Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 102       Marine Group II                    <NA>                    <NA>
    ## 103         Rickettsiales                 S25-593                    <NA>
    ## 104       Marine Group II                    <NA>                    <NA>
    ## 105       Pseudomonadales          Halomonadaceae                 Cobetia
    ## 106    Puniceispirillales            SAR116 clade                    <NA>
    ## 107                  <NA>                    <NA>                    <NA>
    ## 108       Rhodobacterales        Rhodobacteraceae      Ascidiaceihabitans
    ## 109       Marine Group II                    <NA>                    <NA>
    ## 110       Pseudomonadales           Moraxellaceae           Psychrobacter
    ## 111 Ectothiorhodospirales  Ectothiorhodospiraceae                    <NA>
    ## 112        Microtrichales         Microtrichaceae    Sva0996 marine group
    ## 113      Enterobacterales            Vibrionaceae                  Vibrio
    ## 114      Flavobacteriales       Flavobacteriaceae        NS4 marine group
    ## 115       Xanthomonadales        Xanthomonadaceae        Stenotrophomonas
    ## 116       Dadabacteriales                    <NA>                    <NA>
    ## 117       Marine Group II                    <NA>                    <NA>
    ## 118       Rhodobacterales        Rhodobacteraceae                  HIMB11
    ## 119       Xanthomonadales        Xanthomonadaceae        Stenotrophomonas
    ## 120       Synechococcales            Cyanobiaceae      Cyanobium PCC-6307
    ## 121       Marine Group II                    <NA>                    <NA>
    ## 122           SAR11 clade               Clade III                    <NA>
    ## 123      Defluviicoccales                    <NA>                    <NA>
    ## 124                  <NA>                    <NA>                    <NA>
    ## 125      Rhodospirillales       Thalassospiraceae           Thalassospira
    ## 126        Microtrichales         Microtrichaceae    Sva0996 marine group
    ## 127       Marine Group II                    <NA>                    <NA>
    ## 128                  <NA>                    <NA>                    <NA>
    ## 129       Pseudomonadales           Moraxellaceae           Psychrobacter
    ## 130    Verrucomicrobiales                  DEV007                    <NA>
    ## 131       Pseudomonadales             SAR86 clade                    <NA>
    ## 132       Pseudomonadales           Moraxellaceae           Psychrobacter
    ## 133                  <NA>                    <NA>                    <NA>
    ## 134      Flavobacteriales       Flavobacteriaceae        NS5 marine group
    ## 135       Pseudomonadales             SAR86 clade                    <NA>
    ## 136       Pseudomonadales             SAR86 clade                    <NA>
    ## 137       Rhodobacterales        Rhodobacteraceae     Confluentimicrobium
    ## 138       Marine Group II                    <NA>                    <NA>
    ## 139      Flavobacteriales       Flavobacteriaceae       NS2b marine group
    ## 140        Microtrichales         Microtrichaceae    Sva0996 marine group
    ## 141    Puniceispirillales            SAR116 clade                    <NA>
    ## 142    Verrucomicrobiales                  DEV007                    <NA>
    ## 143        Parvibaculales         Parvibaculaceae                    <NA>
    ## 144      Flavobacteriales       Flavobacteriaceae        NS5 marine group
    ## 145         Thiotrichales          Thiotrichaceae                    <NA>
    ## 146       Burkholderiales        Burkholderiaceae               Ralstonia
    ## 147       Pseudomonadales     Pseudohongiellaceae         Pseudohongiella
    ## 148      Enterobacterales  Pseudoalteromonadaceae       Pseudoalteromonas
    ## 149         Rickettsiales                     AB1                    <NA>
    ## 150      Flavobacteriales          Cryomorphaceae                    <NA>
    ## 151        Parvibaculales            OCS116 clade                    <NA>
    ## 152          Cytophagales       Cyclobacteriaceae           Marinoscillum
    ## 153                  <NA>                    <NA>                    <NA>
    ## 154    Puniceispirillales                    <NA>                    <NA>
    ## 155        Bradymonadales                    <NA>                    <NA>
    ## 156 Ectothiorhodospirales  Ectothiorhodospiraceae                    <NA>
    ## 157            Opitutales        Puniceicoccaceae            Cerasicoccus
    ## 158      Sphingomonadales       Sphingomonadaceae           Erythrobacter
    ## 159           SAR11 clade                Clade II                    <NA>
    ## 160      Defluviicoccales                    <NA>                    <NA>
    ##         Species
    ## 1          <NA>
    ## 2          <NA>
    ## 3          <NA>
    ## 4          <NA>
    ## 5          <NA>
    ## 6          <NA>
    ## 7          <NA>
    ## 8          <NA>
    ## 9          <NA>
    ## 10         <NA>
    ## 11         <NA>
    ## 12      marinus
    ## 13         <NA>
    ## 14         <NA>
    ## 15         <NA>
    ## 16         <NA>
    ## 17         <NA>
    ## 18         <NA>
    ## 19         <NA>
    ## 20         <NA>
    ## 21         <NA>
    ## 22         <NA>
    ## 23         <NA>
    ## 24         <NA>
    ## 25         <NA>
    ## 26         <NA>
    ## 27         <NA>
    ## 28         <NA>
    ## 29         <NA>
    ## 30         <NA>
    ## 31         <NA>
    ## 32         <NA>
    ## 33         <NA>
    ## 34         <NA>
    ## 35         <NA>
    ## 36         <NA>
    ## 37         <NA>
    ## 38         <NA>
    ## 39         <NA>
    ## 40         <NA>
    ## 41         <NA>
    ## 42         <NA>
    ## 43         <NA>
    ## 44      marinus
    ## 45         <NA>
    ## 46         <NA>
    ## 47         <NA>
    ## 48         <NA>
    ## 49         <NA>
    ## 50         <NA>
    ## 51         <NA>
    ## 52         <NA>
    ## 53         <NA>
    ## 54         <NA>
    ## 55         <NA>
    ## 56         <NA>
    ## 57         <NA>
    ## 58         <NA>
    ## 59         <NA>
    ## 60         <NA>
    ## 61         <NA>
    ## 62         <NA>
    ## 63         <NA>
    ## 64  maltophilia
    ## 65         <NA>
    ## 66     eburneus
    ## 67         <NA>
    ## 68       fortis
    ## 69         <NA>
    ## 70      marinus
    ## 71         <NA>
    ## 72         <NA>
    ## 73         <NA>
    ## 74         <NA>
    ## 75         <NA>
    ## 76         <NA>
    ## 77         <NA>
    ## 78         <NA>
    ## 79         <NA>
    ## 80         <NA>
    ## 81         <NA>
    ## 82         <NA>
    ## 83         <NA>
    ## 84         <NA>
    ## 85         <NA>
    ## 86         <NA>
    ## 87         <NA>
    ## 88        celer
    ## 89         <NA>
    ## 90         <NA>
    ## 91         <NA>
    ## 92         <NA>
    ## 93         <NA>
    ## 94         <NA>
    ## 95         <NA>
    ## 96         <NA>
    ## 97         <NA>
    ## 98         <NA>
    ## 99         <NA>
    ## 100        <NA>
    ## 101        <NA>
    ## 102        <NA>
    ## 103        <NA>
    ## 104        <NA>
    ## 105      marina
    ## 106        <NA>
    ## 107        <NA>
    ## 108        <NA>
    ## 109        <NA>
    ## 110   marincola
    ## 111        <NA>
    ## 112        <NA>
    ## 113        <NA>
    ## 114        <NA>
    ## 115 maltophilia
    ## 116        <NA>
    ## 117        <NA>
    ## 118        <NA>
    ## 119 maltophilia
    ## 120        <NA>
    ## 121        <NA>
    ## 122        <NA>
    ## 123        <NA>
    ## 124        <NA>
    ## 125        <NA>
    ## 126        <NA>
    ## 127        <NA>
    ## 128        <NA>
    ## 129        <NA>
    ## 130        <NA>
    ## 131        <NA>
    ## 132        <NA>
    ## 133        <NA>
    ## 134        <NA>
    ## 135        <NA>
    ## 136        <NA>
    ## 137        <NA>
    ## 138        <NA>
    ## 139        <NA>
    ## 140        <NA>
    ## 141        <NA>
    ## 142        <NA>
    ## 143        <NA>
    ## 144        <NA>
    ## 145        <NA>
    ## 146        <NA>
    ## 147        <NA>
    ## 148        <NA>
    ## 149        <NA>
    ## 150        <NA>
    ## 151        <NA>
    ## 152        <NA>
    ## 153        <NA>
    ## 154        <NA>
    ## 155        <NA>
    ## 156        <NA>
    ## 157        <NA>
    ## 158        <NA>
    ## 159        <NA>
    ## 160        <NA>

``` r
write.table(seqtab_nochim_export,
            file = file.path(export_folder, "asv_table.tsv"),
            quote = FALSE,
            sep = "\t",
            row.names = FALSE)
```

#### Résultat asv tsv

``` r
Resultatasvtsv <- read.delim("outputs/dada2/asv_table/asv_table.tsv")
ResultatTaxotsv
```

    ##         asv  Kingdom                        Phylum               Class
    ## 1   ASV_001 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 2   ASV_002 Bacteria                Proteobacteria Alphaproteobacteria
    ## 3   ASV_003 Bacteria                Proteobacteria Gammaproteobacteria
    ## 4   ASV_004 Bacteria                Proteobacteria Alphaproteobacteria
    ## 5   ASV_005  Archaea              Thermoplasmatota      Thermoplasmata
    ## 6   ASV_006 Bacteria                Proteobacteria Alphaproteobacteria
    ## 7   ASV_007 Bacteria                Proteobacteria Gammaproteobacteria
    ## 8   ASV_008 Bacteria                Proteobacteria Alphaproteobacteria
    ## 9   ASV_009 Bacteria                Proteobacteria Alphaproteobacteria
    ## 10  ASV_010 Bacteria                Proteobacteria Alphaproteobacteria
    ## 11  ASV_011 Bacteria                Proteobacteria Alphaproteobacteria
    ## 12  ASV_012 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 13  ASV_013 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 14  ASV_014 Bacteria                Proteobacteria Alphaproteobacteria
    ## 15  ASV_015 Bacteria                Proteobacteria Alphaproteobacteria
    ## 16  ASV_016 Bacteria                Proteobacteria Gammaproteobacteria
    ## 17  ASV_017 Bacteria                Proteobacteria Alphaproteobacteria
    ## 18  ASV_018 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 19  ASV_019  Archaea              Thermoplasmatota      Thermoplasmata
    ## 20  ASV_020  Archaea              Thermoplasmatota      Thermoplasmata
    ## 21  ASV_021 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 22  ASV_022 Bacteria                  Bacteroidota         Bacteroidia
    ## 23  ASV_023 Bacteria                Proteobacteria Alphaproteobacteria
    ## 24  ASV_024 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 25  ASV_025 Bacteria                Proteobacteria Gammaproteobacteria
    ## 26  ASV_026 Bacteria                Proteobacteria Gammaproteobacteria
    ## 27  ASV_027 Bacteria                Proteobacteria Alphaproteobacteria
    ## 28  ASV_028 Bacteria                Proteobacteria Alphaproteobacteria
    ## 29  ASV_029 Bacteria                Proteobacteria Alphaproteobacteria
    ## 30  ASV_030 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 31  ASV_031  Archaea              Thermoplasmatota      Thermoplasmata
    ## 32  ASV_032 Bacteria                Proteobacteria Alphaproteobacteria
    ## 33  ASV_033 Bacteria                  Dadabacteria       Dadabacteriia
    ## 34  ASV_034 Bacteria                Proteobacteria Alphaproteobacteria
    ## 35  ASV_035 Bacteria                Proteobacteria Alphaproteobacteria
    ## 36  ASV_036 Bacteria  SAR324 clade(Marine group B)                <NA>
    ## 37  ASV_037 Bacteria                Proteobacteria Gammaproteobacteria
    ## 38  ASV_038 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 39  ASV_039  Archaea              Thermoplasmatota      Thermoplasmata
    ## 40  ASV_040 Bacteria                Proteobacteria Alphaproteobacteria
    ## 41  ASV_041 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 42  ASV_042 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 43  ASV_043  Archaea              Thermoplasmatota      Thermoplasmata
    ## 44  ASV_044 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 45  ASV_045  Archaea              Thermoplasmatota      Thermoplasmata
    ## 46  ASV_046  Archaea              Thermoplasmatota      Thermoplasmata
    ## 47  ASV_047 Bacteria                Proteobacteria Alphaproteobacteria
    ## 48  ASV_048 Bacteria                   Chloroflexi     Dehalococcoidia
    ## 49  ASV_049 Bacteria                   Chloroflexi     Dehalococcoidia
    ## 50  ASV_050 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 51  ASV_051 Bacteria             Verrucomicrobiota    Verrucomicrobiae
    ## 52  ASV_052 Bacteria  SAR324 clade(Marine group B)                <NA>
    ## 53  ASV_053 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 54  ASV_054 Bacteria                  Bacteroidota         Bacteroidia
    ## 55  ASV_055  Archaea              Thermoplasmatota      Thermoplasmata
    ## 56  ASV_056 Bacteria                Proteobacteria Alphaproteobacteria
    ## 57  ASV_057 Bacteria                Proteobacteria Gammaproteobacteria
    ## 58  ASV_058 Bacteria                  Bacteroidota         Bacteroidia
    ## 59  ASV_059 Bacteria                Proteobacteria Alphaproteobacteria
    ## 60  ASV_060 Bacteria                Proteobacteria Gammaproteobacteria
    ## 61  ASV_061 Bacteria                Proteobacteria Alphaproteobacteria
    ## 62  ASV_062 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 63  ASV_063 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 64  ASV_064 Bacteria                Proteobacteria Gammaproteobacteria
    ## 65  ASV_065 Bacteria                Proteobacteria Alphaproteobacteria
    ## 66  ASV_066 Bacteria                Proteobacteria Alphaproteobacteria
    ## 67  ASV_067 Bacteria                Proteobacteria Gammaproteobacteria
    ## 68  ASV_068 Bacteria                Proteobacteria Gammaproteobacteria
    ## 69  ASV_069 Bacteria                  Bacteroidota         Bacteroidia
    ## 70  ASV_070 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 71  ASV_071 Bacteria                Proteobacteria Gammaproteobacteria
    ## 72  ASV_072 Bacteria                Proteobacteria Alphaproteobacteria
    ## 73  ASV_073 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 74  ASV_074 Bacteria                Proteobacteria Alphaproteobacteria
    ## 75  ASV_075  Archaea              Thermoplasmatota      Thermoplasmata
    ## 76  ASV_076 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 77  ASV_077 Bacteria                Proteobacteria Alphaproteobacteria
    ## 78  ASV_078 Bacteria                Proteobacteria Gammaproteobacteria
    ## 79  ASV_079 Bacteria                Proteobacteria Alphaproteobacteria
    ## 80  ASV_080 Bacteria                Proteobacteria Alphaproteobacteria
    ## 81  ASV_081 Bacteria                  Bacteroidota         Bacteroidia
    ## 82  ASV_082 Bacteria                Proteobacteria Gammaproteobacteria
    ## 83  ASV_083 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 84  ASV_084 Bacteria                Proteobacteria Gammaproteobacteria
    ## 85  ASV_085 Bacteria                Proteobacteria Alphaproteobacteria
    ## 86  ASV_086 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 87  ASV_087  Archaea              Thermoplasmatota      Thermoplasmata
    ## 88  ASV_088 Bacteria                Proteobacteria Gammaproteobacteria
    ## 89  ASV_089 Bacteria                Proteobacteria Alphaproteobacteria
    ## 90  ASV_090 Bacteria                Proteobacteria Gammaproteobacteria
    ## 91  ASV_091 Bacteria                Proteobacteria Gammaproteobacteria
    ## 92  ASV_092 Bacteria                Proteobacteria Alphaproteobacteria
    ## 93  ASV_093 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 94  ASV_094 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 95  ASV_095  Archaea              Thermoplasmatota      Thermoplasmata
    ## 96  ASV_096 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 97  ASV_097  Archaea              Thermoplasmatota      Thermoplasmata
    ## 98  ASV_098 Bacteria                Proteobacteria Gammaproteobacteria
    ## 99  ASV_099 Bacteria                Proteobacteria Gammaproteobacteria
    ## 100 ASV_100 Bacteria                Proteobacteria Alphaproteobacteria
    ## 101 ASV_101 Bacteria                Proteobacteria Alphaproteobacteria
    ## 102 ASV_102  Archaea              Thermoplasmatota      Thermoplasmata
    ## 103 ASV_103 Bacteria                Proteobacteria Alphaproteobacteria
    ## 104 ASV_104  Archaea              Thermoplasmatota      Thermoplasmata
    ## 105 ASV_105 Bacteria                Proteobacteria Gammaproteobacteria
    ## 106 ASV_106 Bacteria                Proteobacteria Alphaproteobacteria
    ## 107 ASV_107 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 108 ASV_108 Bacteria                Proteobacteria Alphaproteobacteria
    ## 109 ASV_109  Archaea              Thermoplasmatota      Thermoplasmata
    ## 110 ASV_110 Bacteria                Proteobacteria Gammaproteobacteria
    ## 111 ASV_111 Bacteria                Proteobacteria Gammaproteobacteria
    ## 112 ASV_112 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 113 ASV_113 Bacteria                Proteobacteria Gammaproteobacteria
    ## 114 ASV_114 Bacteria                  Bacteroidota         Bacteroidia
    ## 115 ASV_115 Bacteria                Proteobacteria Gammaproteobacteria
    ## 116 ASV_116 Bacteria                  Dadabacteria       Dadabacteriia
    ## 117 ASV_117  Archaea              Thermoplasmatota      Thermoplasmata
    ## 118 ASV_118 Bacteria                Proteobacteria Alphaproteobacteria
    ## 119 ASV_119 Bacteria                Proteobacteria Gammaproteobacteria
    ## 120 ASV_120 Bacteria                 Cyanobacteria      Cyanobacteriia
    ## 121 ASV_121  Archaea              Thermoplasmatota      Thermoplasmata
    ## 122 ASV_122 Bacteria                Proteobacteria Alphaproteobacteria
    ## 123 ASV_123 Bacteria                Proteobacteria Alphaproteobacteria
    ## 124 ASV_124 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 125 ASV_125 Bacteria                Proteobacteria Alphaproteobacteria
    ## 126 ASV_126 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 127 ASV_127  Archaea              Thermoplasmatota      Thermoplasmata
    ## 128 ASV_128 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 129 ASV_129 Bacteria                Proteobacteria Gammaproteobacteria
    ## 130 ASV_130 Bacteria             Verrucomicrobiota    Verrucomicrobiae
    ## 131 ASV_131 Bacteria                Proteobacteria Gammaproteobacteria
    ## 132 ASV_132 Bacteria                Proteobacteria Gammaproteobacteria
    ## 133 ASV_133 Bacteria                Proteobacteria Alphaproteobacteria
    ## 134 ASV_134 Bacteria                  Bacteroidota         Bacteroidia
    ## 135 ASV_135 Bacteria                Proteobacteria Gammaproteobacteria
    ## 136 ASV_136 Bacteria                Proteobacteria Gammaproteobacteria
    ## 137 ASV_137 Bacteria                Proteobacteria Alphaproteobacteria
    ## 138 ASV_138  Archaea              Thermoplasmatota      Thermoplasmata
    ## 139 ASV_139 Bacteria                  Bacteroidota         Bacteroidia
    ## 140 ASV_140 Bacteria              Actinobacteriota      Acidimicrobiia
    ## 141 ASV_141 Bacteria                Proteobacteria Alphaproteobacteria
    ## 142 ASV_142 Bacteria             Verrucomicrobiota    Verrucomicrobiae
    ## 143 ASV_143 Bacteria                Proteobacteria Alphaproteobacteria
    ## 144 ASV_144 Bacteria                  Bacteroidota         Bacteroidia
    ## 145 ASV_145 Bacteria                Proteobacteria Gammaproteobacteria
    ## 146 ASV_146 Bacteria                Proteobacteria Gammaproteobacteria
    ## 147 ASV_147 Bacteria                Proteobacteria Gammaproteobacteria
    ## 148 ASV_148 Bacteria                Proteobacteria Gammaproteobacteria
    ## 149 ASV_149 Bacteria                Proteobacteria Alphaproteobacteria
    ## 150 ASV_150 Bacteria                  Bacteroidota         Bacteroidia
    ## 151 ASV_151 Bacteria                Proteobacteria Alphaproteobacteria
    ## 152 ASV_152 Bacteria                  Bacteroidota         Bacteroidia
    ## 153 ASV_153 Bacteria Marinimicrobia (SAR406 clade)                <NA>
    ## 154 ASV_154 Bacteria                Proteobacteria Alphaproteobacteria
    ## 155 ASV_155 Bacteria              Desulfobacterota    Desulfuromonadia
    ## 156 ASV_156 Bacteria                Proteobacteria Gammaproteobacteria
    ## 157 ASV_157 Bacteria             Verrucomicrobiota    Verrucomicrobiae
    ## 158 ASV_158 Bacteria                Proteobacteria Alphaproteobacteria
    ## 159 ASV_159 Bacteria                Proteobacteria Alphaproteobacteria
    ## 160 ASV_160 Bacteria                Proteobacteria Alphaproteobacteria
    ##                     Order                  Family                   Genus
    ## 1         Synechococcales            Cyanobiaceae    Synechococcus CC9902
    ## 2             SAR11 clade                 Clade I                Clade Ia
    ## 3        Enterobacterales  Pseudoalteromonadaceae       Pseudoalteromonas
    ## 4             SAR11 clade                 Clade I                Clade Ia
    ## 5         Marine Group II                    <NA>                    <NA>
    ## 6        Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 7        Enterobacterales  Pseudoalteromonadaceae       Pseudoalteromonas
    ## 8             SAR11 clade                Clade II                    <NA>
    ## 9             SAR11 clade                 Clade I                Clade Ia
    ## 10       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 11            SAR11 clade                 Clade I                Clade Ia
    ## 12        Synechococcales            Cyanobiaceae Prochlorococcus MIT9313
    ## 13        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 14            SAR11 clade                Clade II                    <NA>
    ## 15       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 16       Enterobacterales        Alteromonadaceae             Alteromonas
    ## 17            SAR11 clade                 Clade I                Clade Ib
    ## 18        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 19        Marine Group II                    <NA>                    <NA>
    ## 20        Marine Group II                    <NA>                    <NA>
    ## 21            Chloroplast                    <NA>                    <NA>
    ## 22       Flavobacteriales       Flavobacteriaceae        NS4 marine group
    ## 23            SAR11 clade                 Clade I                Clade Ia
    ## 24        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 25        Pseudomonadales             SAR86 clade                    <NA>
    ## 26       Enterobacterales  Pseudoalteromonadaceae       Pseudoalteromonas
    ## 27       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 28            SAR11 clade                 Clade I                Clade Ia
    ## 29            SAR11 clade                 Clade I                Clade Ib
    ## 30        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 31       Marine Group III                    <NA>                    <NA>
    ## 32            SAR11 clade                Clade IV                    <NA>
    ## 33        Dadabacteriales                    <NA>                    <NA>
    ## 34        Rhodobacterales        Rhodobacteraceae                    <NA>
    ## 35       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 36                   <NA>                    <NA>                    <NA>
    ## 37        Pseudomonadales           Moraxellaceae           Acinetobacter
    ## 38        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 39        Marine Group II                    <NA>                    <NA>
    ## 40       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 41        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 42        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 43        Marine Group II                    <NA>                    <NA>
    ## 44        Synechococcales            Cyanobiaceae Prochlorococcus MIT9313
    ## 45        Marine Group II                    <NA>                    <NA>
    ## 46        Marine Group II                    <NA>                    <NA>
    ## 47       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 48           SAR202 clade                    <NA>                    <NA>
    ## 49           SAR202 clade                    <NA>                    <NA>
    ## 50        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 51         Pedosphaerales         Pedosphaeraceae         SCGC AAA164-E04
    ## 52                   <NA>                    <NA>                    <NA>
    ## 53        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 54       Flavobacteriales          Cryomorphaceae                    <NA>
    ## 55        Marine Group II                    <NA>                    <NA>
    ## 56            SAR11 clade                Clade IV                    <NA>
    ## 57        Pseudomonadales             SAR86 clade                    <NA>
    ## 58       Flavobacteriales       Flavobacteriaceae        NS5 marine group
    ## 59     Puniceispirillales            SAR116 clade                    <NA>
    ## 60        Xanthomonadales        Xanthomonadaceae        Stenotrophomonas
    ## 61       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 62            Chloroplast                    <NA>                    <NA>
    ## 63            Chloroplast                    <NA>                    <NA>
    ## 64        Xanthomonadales        Xanthomonadaceae        Stenotrophomonas
    ## 65       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 66        Rhodobacterales        Rhodobacteraceae              Donghicola
    ## 67        Pseudomonadales             SAR86 clade                    <NA>
    ## 68       Enterobacterales            Vibrionaceae                  Vibrio
    ## 69       Flavobacteriales       Flavobacteriaceae        NS5 marine group
    ## 70        Synechococcales            Cyanobiaceae Prochlorococcus MIT9313
    ## 71        Pseudomonadales        Pseudomonadaceae             Pseudomonas
    ## 72        Rhodobacterales        Rhodobacteraceae                    <NA>
    ## 73            Chloroplast                    <NA>                    <NA>
    ## 74       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 75        Marine Group II                    <NA>                    <NA>
    ## 76        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 77        Rhodobacterales        Rhodobacteraceae      Ascidiaceihabitans
    ## 78  Ectothiorhodospirales  Ectothiorhodospiraceae                    <NA>
    ## 79      Thalassobaculales              Nisaeaceae              OM75 clade
    ## 80            SAR11 clade                 Clade I                Clade Ib
    ## 81       Flavobacteriales       Flavobacteriaceae       NS2b marine group
    ## 82        Pseudomonadales             SAR86 clade                    <NA>
    ## 83                   <NA>                    <NA>                    <NA>
    ## 84        Pseudomonadales             SAR86 clade                    <NA>
    ## 85          Rickettsiales                 S25-593                    <NA>
    ## 86                   <NA>                    <NA>                    <NA>
    ## 87        Marine Group II                    <NA>                    <NA>
    ## 88        Pseudomonadales           Moraxellaceae           Psychrobacter
    ## 89       Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 90        Pseudomonadales             OM182 clade                    <NA>
    ## 91        Pseudomonadales           Moraxellaceae           Acinetobacter
    ## 92          Rickettsiales                 S25-593                    <NA>
    ## 93                   <NA>                    <NA>                    <NA>
    ## 94                   <NA>                    <NA>                    <NA>
    ## 95        Marine Group II                    <NA>                    <NA>
    ## 96        Actinomarinales        Actinomarinaceae Candidatus Actinomarina
    ## 97        Marine Group II                    <NA>                    <NA>
    ## 98        Pseudomonadales             SAR86 clade                    <NA>
    ## 99        Pseudomonadales          Halomonadaceae               Halomonas
    ## 100      Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 101      Rhodospirillales AEGEAN-169 marine group                    <NA>
    ## 102       Marine Group II                    <NA>                    <NA>
    ## 103         Rickettsiales                 S25-593                    <NA>
    ## 104       Marine Group II                    <NA>                    <NA>
    ## 105       Pseudomonadales          Halomonadaceae                 Cobetia
    ## 106    Puniceispirillales            SAR116 clade                    <NA>
    ## 107                  <NA>                    <NA>                    <NA>
    ## 108       Rhodobacterales        Rhodobacteraceae      Ascidiaceihabitans
    ## 109       Marine Group II                    <NA>                    <NA>
    ## 110       Pseudomonadales           Moraxellaceae           Psychrobacter
    ## 111 Ectothiorhodospirales  Ectothiorhodospiraceae                    <NA>
    ## 112        Microtrichales         Microtrichaceae    Sva0996 marine group
    ## 113      Enterobacterales            Vibrionaceae                  Vibrio
    ## 114      Flavobacteriales       Flavobacteriaceae        NS4 marine group
    ## 115       Xanthomonadales        Xanthomonadaceae        Stenotrophomonas
    ## 116       Dadabacteriales                    <NA>                    <NA>
    ## 117       Marine Group II                    <NA>                    <NA>
    ## 118       Rhodobacterales        Rhodobacteraceae                  HIMB11
    ## 119       Xanthomonadales        Xanthomonadaceae        Stenotrophomonas
    ## 120       Synechococcales            Cyanobiaceae      Cyanobium PCC-6307
    ## 121       Marine Group II                    <NA>                    <NA>
    ## 122           SAR11 clade               Clade III                    <NA>
    ## 123      Defluviicoccales                    <NA>                    <NA>
    ## 124                  <NA>                    <NA>                    <NA>
    ## 125      Rhodospirillales       Thalassospiraceae           Thalassospira
    ## 126        Microtrichales         Microtrichaceae    Sva0996 marine group
    ## 127       Marine Group II                    <NA>                    <NA>
    ## 128                  <NA>                    <NA>                    <NA>
    ## 129       Pseudomonadales           Moraxellaceae           Psychrobacter
    ## 130    Verrucomicrobiales                  DEV007                    <NA>
    ## 131       Pseudomonadales             SAR86 clade                    <NA>
    ## 132       Pseudomonadales           Moraxellaceae           Psychrobacter
    ## 133                  <NA>                    <NA>                    <NA>
    ## 134      Flavobacteriales       Flavobacteriaceae        NS5 marine group
    ## 135       Pseudomonadales             SAR86 clade                    <NA>
    ## 136       Pseudomonadales             SAR86 clade                    <NA>
    ## 137       Rhodobacterales        Rhodobacteraceae     Confluentimicrobium
    ## 138       Marine Group II                    <NA>                    <NA>
    ## 139      Flavobacteriales       Flavobacteriaceae       NS2b marine group
    ## 140        Microtrichales         Microtrichaceae    Sva0996 marine group
    ## 141    Puniceispirillales            SAR116 clade                    <NA>
    ## 142    Verrucomicrobiales                  DEV007                    <NA>
    ## 143        Parvibaculales         Parvibaculaceae                    <NA>
    ## 144      Flavobacteriales       Flavobacteriaceae        NS5 marine group
    ## 145         Thiotrichales          Thiotrichaceae                    <NA>
    ## 146       Burkholderiales        Burkholderiaceae               Ralstonia
    ## 147       Pseudomonadales     Pseudohongiellaceae         Pseudohongiella
    ## 148      Enterobacterales  Pseudoalteromonadaceae       Pseudoalteromonas
    ## 149         Rickettsiales                     AB1                    <NA>
    ## 150      Flavobacteriales          Cryomorphaceae                    <NA>
    ## 151        Parvibaculales            OCS116 clade                    <NA>
    ## 152          Cytophagales       Cyclobacteriaceae           Marinoscillum
    ## 153                  <NA>                    <NA>                    <NA>
    ## 154    Puniceispirillales                    <NA>                    <NA>
    ## 155        Bradymonadales                    <NA>                    <NA>
    ## 156 Ectothiorhodospirales  Ectothiorhodospiraceae                    <NA>
    ## 157            Opitutales        Puniceicoccaceae            Cerasicoccus
    ## 158      Sphingomonadales       Sphingomonadaceae           Erythrobacter
    ## 159           SAR11 clade                Clade II                    <NA>
    ## 160      Defluviicoccales                    <NA>                    <NA>
    ##         Species
    ## 1          <NA>
    ## 2          <NA>
    ## 3          <NA>
    ## 4          <NA>
    ## 5          <NA>
    ## 6          <NA>
    ## 7          <NA>
    ## 8          <NA>
    ## 9          <NA>
    ## 10         <NA>
    ## 11         <NA>
    ## 12      marinus
    ## 13         <NA>
    ## 14         <NA>
    ## 15         <NA>
    ## 16         <NA>
    ## 17         <NA>
    ## 18         <NA>
    ## 19         <NA>
    ## 20         <NA>
    ## 21         <NA>
    ## 22         <NA>
    ## 23         <NA>
    ## 24         <NA>
    ## 25         <NA>
    ## 26         <NA>
    ## 27         <NA>
    ## 28         <NA>
    ## 29         <NA>
    ## 30         <NA>
    ## 31         <NA>
    ## 32         <NA>
    ## 33         <NA>
    ## 34         <NA>
    ## 35         <NA>
    ## 36         <NA>
    ## 37         <NA>
    ## 38         <NA>
    ## 39         <NA>
    ## 40         <NA>
    ## 41         <NA>
    ## 42         <NA>
    ## 43         <NA>
    ## 44      marinus
    ## 45         <NA>
    ## 46         <NA>
    ## 47         <NA>
    ## 48         <NA>
    ## 49         <NA>
    ## 50         <NA>
    ## 51         <NA>
    ## 52         <NA>
    ## 53         <NA>
    ## 54         <NA>
    ## 55         <NA>
    ## 56         <NA>
    ## 57         <NA>
    ## 58         <NA>
    ## 59         <NA>
    ## 60         <NA>
    ## 61         <NA>
    ## 62         <NA>
    ## 63         <NA>
    ## 64  maltophilia
    ## 65         <NA>
    ## 66     eburneus
    ## 67         <NA>
    ## 68       fortis
    ## 69         <NA>
    ## 70      marinus
    ## 71         <NA>
    ## 72         <NA>
    ## 73         <NA>
    ## 74         <NA>
    ## 75         <NA>
    ## 76         <NA>
    ## 77         <NA>
    ## 78         <NA>
    ## 79         <NA>
    ## 80         <NA>
    ## 81         <NA>
    ## 82         <NA>
    ## 83         <NA>
    ## 84         <NA>
    ## 85         <NA>
    ## 86         <NA>
    ## 87         <NA>
    ## 88        celer
    ## 89         <NA>
    ## 90         <NA>
    ## 91         <NA>
    ## 92         <NA>
    ## 93         <NA>
    ## 94         <NA>
    ## 95         <NA>
    ## 96         <NA>
    ## 97         <NA>
    ## 98         <NA>
    ## 99         <NA>
    ## 100        <NA>
    ## 101        <NA>
    ## 102        <NA>
    ## 103        <NA>
    ## 104        <NA>
    ## 105      marina
    ## 106        <NA>
    ## 107        <NA>
    ## 108        <NA>
    ## 109        <NA>
    ## 110   marincola
    ## 111        <NA>
    ## 112        <NA>
    ## 113        <NA>
    ## 114        <NA>
    ## 115 maltophilia
    ## 116        <NA>
    ## 117        <NA>
    ## 118        <NA>
    ## 119 maltophilia
    ## 120        <NA>
    ## 121        <NA>
    ## 122        <NA>
    ## 123        <NA>
    ## 124        <NA>
    ## 125        <NA>
    ## 126        <NA>
    ## 127        <NA>
    ## 128        <NA>
    ## 129        <NA>
    ## 130        <NA>
    ## 131        <NA>
    ## 132        <NA>
    ## 133        <NA>
    ## 134        <NA>
    ## 135        <NA>
    ## 136        <NA>
    ## 137        <NA>
    ## 138        <NA>
    ## 139        <NA>
    ## 140        <NA>
    ## 141        <NA>
    ## 142        <NA>
    ## 143        <NA>
    ## 144        <NA>
    ## 145        <NA>
    ## 146        <NA>
    ## 147        <NA>
    ## 148        <NA>
    ## 149        <NA>
    ## 150        <NA>
    ## 151        <NA>
    ## 152        <NA>
    ## 153        <NA>
    ## 154        <NA>
    ## 155        <NA>
    ## 156        <NA>
    ## 157        <NA>
    ## 158        <NA>
    ## 159        <NA>
    ## 160        <NA>

``` r
cat(paste0(">", names(asv_seq), "\n", asv_seq),
    sep = "\n",
    file = file.path(export_folder, "asv.fasta"))
```

#### Résultat asv.fasta

``` r
library(Biostrings)
```

    ## Loading required package: BiocGenerics

    ## 
    ## Attaching package: 'BiocGenerics'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     IQR, mad, sd, var, xtabs

    ## The following objects are masked from 'package:base':
    ## 
    ##     anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    ##     colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    ##     get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    ##     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    ##     Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    ##     table, tapply, union, unique, unsplit, which.max, which.min

    ## Loading required package: S4Vectors

    ## Loading required package: stats4

    ## 
    ## Attaching package: 'S4Vectors'

    ## The following object is masked from 'package:utils':
    ## 
    ##     findMatches

    ## The following objects are masked from 'package:base':
    ## 
    ##     expand.grid, I, unname

    ## Loading required package: IRanges

    ## Loading required package: XVector

    ## Loading required package: GenomeInfoDb

    ## 
    ## Attaching package: 'Biostrings'

    ## The following object is masked from 'package:base':
    ## 
    ##     strsplit

``` r
path_asv.fasta <- "outputs/dada2/asv_table/asv.fasta"
Resultatasvfasta <- readDNAStringSet(path_asv.fasta)
Resultatasvfasta
```

    ## DNAStringSet object of length 160:
    ##       width seq                                             names               
    ##   [1]   406 TGGGGAATTTTCCGCAATGGGC...GAAAGCCAGGGGAGCGAAAGGG ASV_001
    ##   [2]   404 TGGGGAATCTTGCACAATGGAG...GAAAGCATGGGTAGCGAAGAGG ASV_002
    ##   [3]   429 TGGGGAATATTGCACAATGGGC...GAAAGCGTGGGGAGCAAACAGG ASV_003
    ##   [4]   404 TGGGGAATCTTGCACAATGGAG...GAAAGCATGGGTAGCGAAGAGG ASV_004
    ##   [5]   387 GCGCGAAAACTTGACAATGCGA...GAAGCCTAGGGGCACGAACCGG ASV_005
    ##   ...   ... ...
    ## [156]   429 TGGGGAATATTGCGCAATGGGC...GAAAGCGTGGGGAGCAAACAGG ASV_156
    ## [157]   422 TTTCGAATCATTCACAATGGGC...GAAAGCATGGGGAGCGAAAGGG ASV_157
    ## [158]   404 TGGGGAATATTGGACAATGGGC...GAAAGCGTGGGGAGCAAACAGG ASV_158
    ## [159]   404 TAGGGAATATTGGACAATGGGG...GAAAGCATGGGTAGCGAAGAGG ASV_159
    ## [160]   404 TGGGGAATATTGGACAATGGGC...GAAAGCGTGGGTAGCAAACAGG ASV_160

### 11.3

``` r
getN <- function(x) sum(dada2::getUniques(x))

log_table <- data.frame(
  input = primer_log$in_reads,
  with_fwd_primer = primer_log$`w/adapters`,
  with_rev_primer = primer_log$`w/adapters2` ,
  with_both_primers = out[, 1],
  filtered = out[, 2],
  denoisedF = sapply(dadaFs, getN),
  denoisedR = sapply(dadaRs, getN),
  merged = sapply(mergers, getN),
  nonchim = rowSums(seqtab_nochim),
  perc_retained = rowSums(seqtab_nochim) / out[, 1] * 100
)

rownames(log_table) <- sample_names
```

``` r
df_export(log_table, new_rn = "sample") |>
  write.table(file = file.path(export_folder, "log_table.tsv"),
              quote = FALSE,
              sep = "\t",
              row.names = FALSE)
```

#### Résultat log_table.tsv

``` r
Resultatlogtabletsv <- read.delim("outputs/dada2/asv_table/log_table.tsv")
Resultatlogtabletsv
```

    ##    sample input with_fwd_primer with_rev_primer with_both_primers filtered
    ## 1    S11B  2000            1986            1876              1863     1200
    ## 2     S1B  2000            1975            1877              1855     1251
    ## 3     S2B  2000            1987            1850              1839     1255
    ## 4     S2S  2000            1989            1843              1833     1244
    ## 5     S3B  2000            1989            1870              1860     1244
    ## 6     S3S  2000            1989            1891              1880     1312
    ## 7     S4B  2000            1980            1884              1867     1262
    ## 8     S4S  2000            1987            1884              1872     1328
    ## 9     S5B  2000            1984            1856              1841     1255
    ## 10    S5S  2000            1991            1869              1861     1244
    ## 11    S6B  2000            1981            1857              1839     1251
    ## 12    S6S  2000            1982            1851              1835     1239
    ## 13    S7B  2000            1987            1836              1825     1203
    ## 14    S7S  2000            1987            1857              1845     1182
    ## 15    S8B  2000            1993            1847              1840     1169
    ## 16    S8S  2000            1982            1865              1848     1267
    ## 17    S9B  2000            1983            1851              1834     1195
    ## 18    S9S  2000            1979            1853              1835     1249
    ##    denoisedF denoisedR merged nonchim perc_retained
    ## 1       1066      1015    879     879      47.18196
    ## 2       1004      1053    835     835      45.01348
    ## 3       1051      1023    783     783      42.57749
    ## 4       1093      1110    929     929      50.68194
    ## 5       1020      1001    786     786      42.25806
    ## 6       1108      1132    920     904      48.08511
    ## 7       1090      1032    808     808      43.27799
    ## 8       1181      1170   1050    1050      56.08974
    ## 9       1106      1099    905     905      49.15807
    ## 10      1107      1088    898     896      48.14616
    ## 11      1134      1108    970     970      52.74606
    ## 12      1094      1118    900     900      49.04632
    ## 13      1085      1032    823     823      45.09589
    ## 14      1038      1011    852     852      46.17886
    ## 15      1006      1000    842     842      45.76087
    ## 16      1113      1082    849     849      45.94156
    ## 17      1056      1022    787     787      42.91167
    ## 18      1101      1108    873     873      47.57493
